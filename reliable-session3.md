# Reliable Session

모바일 네트워크 처럼 연결 끊김이 빈번한 환경에서는 안정적인 게임 서비스를 제공하려면, 추가적인 고려사항이 있습니다.

끊어진 TCP 연결을 다시 맺는것은 어려운 일이 아니지만, 재 연결 도중 유실된 메시지를 복원하는것은 쉬운 과정이 아닐 수 있습니다. 더욱이 이러한 처리를 응용레벨에서 처리하는것은 프로그램을 지나치게 복잡하게 만들수 있습니다.

재접속 과정에서 유실된 메시지를 복원하지 못하고 그대로 내버려둘 경우에는 게임의 상태가 정상적이지 않을 수 있으므로, 재연결 후에 게임을 이어서 할 수 없을수 있습니다. 보통 이러한 경우에 가장 손쉬운 방법은 접속이 끊기면 강제로 `홈`으로 보내버리고 재접속을 강제할 수도 있습니다. 하지만, 플레이어는 이러한 과정을 불편하게 생각할것이고 게임의 흐름을 이어갈 수 없는 상황이 될것입니다.

더욱이 모바일 환경에서는 이러한 순간적인 끊김이 빈번하게 발생한다는 것입니다. 수초 이내의 짧은 연결 끊김으로 인해서 매번 홈 화면으로 보내버리면, 플레이어는 안정적인 게임서비스를 받고 있다는 생각을 하지 못할것입니다. 플레이어의 네트워크 환경이 열악하다는 생각은 하지 못한채로 불만만 쌓여 갈것입니다.

이 글에서는 이러한 상황을 개선하기 위한 방법에 대해서 설명하고자 합니다.

## Hand Over

우선 자세한 설명에 앞서 모바일 네트워크 환경의 특성에 대해서 알아 보겠습니다. 모바일은 `PC` 네트워크 환경과 달리 전적으로 무선 환경입니다. 무선 환경은 유선에 비해 상대적으로 매우 불안정한 채널이며 언제든 연결이 끊길 수 있습니다. 특히 이동중에는 `WiFi` <-> `LTE` 로의 전환이 빈번하게 발생할수도 있습니다. 이런 전환을 영어로 `Hand Over`라고 합니다. 전환이 일어나게 되면 한동안은 통신이 이루어지 않으며, 절체 후에는 네트워크 접손이 끊김은 물론이고, 기기의 `IP` 주소가 변경되는 등의 변화가 있을 수 있습니다.

바로 이러한 부분에 대한 대비를 해두어야만 원활한 모바일 네트워크 서비스를 할 수 있을것입니다.

## 극복이 어려운 점

하지만, 이러한 처리가 모든 상황을 극복하지는 못합니다. 다음의 상황에서는 유저를 `홈` 화면으로 보내야할지도 모릅니다. 다만, 이러한 처리를 함으로써 서비스의 질을 조금더 향상시킬 수 있을겁니다.

- `WiFi` 수신 감도가 낮아졌을 경우, 커넥션이 끊김을 감지할때까지 상당시간 소요됨.
- `LB(Load Balancer)` 뒤에 서버가 위치해 있을 경우.

위 문제들에 대해서는 아래에서 좀더 자세하게 다루겠습니다.

### WiFi 수신 감도가 낮아졌을 경우

